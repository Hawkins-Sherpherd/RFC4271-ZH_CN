# 安全观点

一个 BGP 实现**必须**支持 RFC 2385 [[RFC2385](https://www.rfc-editor.org/rfc/rfc2385.html)] 中定义的认证机制。由此提供的认证机制应能在每对等体间认证的场景下使用。

BGP 在对等体路由器之间的的流量利用 TCP 实现可靠传输。为了提供点对点场景下的面向连接的完整性和数据来源认证，BGP 规范使用 RFC 2385 中定义的机制。这些服务旨在检测和拒绝针对路由器之间的 TCP 连接的线路侦听攻击。这些机制的缺乏将影响这些安全服务，攻击者便可破坏 TCP 连接并且/或者伪装成一台合法的对等体路由器。因为 RFC 中定义的机制并不能提供对等体到实体的认证，这些连接可能会被一些无法在 TCP 层面上检测到的重放攻击攻陷。这种攻击可能导致传递（从 TCP）“损坏的”或“伪造的” BGP 报文。

RFC 2385 中定义的机制通过在与 TCP 校验和使用的相同数据之上进行计算得出16字节的报文验证码（MAC）将常规的 TCP 校验和增强。这个 MAC 是基于单向哈希函数（MD5）和密钥的。密钥是在对等体路由器之间预共享的，用于生成无法得到密钥的攻击者无法得知的 MAC 值。一个符合规则的实现必须支持这些机制，并且必须允许网络管理员去在每对等体的场景下使用它。

RFC 2385 并没有指定一种管理（例如生成，分发和替换）用于计算 MAC 的密钥的方法。RFC 3562 [[RFC3562](https://www.rfc-editor.org/rfc/rfc3562.html)]（一个信息性的文档）提供了一些该领域的引导，并提供了基础原理以支持这种引导。它提到应用不同的密钥和每个受保护的对等体的通信。如果一个同样的密钥用在多个对等连接上，那提供的安全服务将会降级，比如，增加单个路由器泄露密钥对其它路由器造成有害影响的风险。

MAC 计算所使用的密钥应该周期性更换，以最小化密钥泄露或成功的密码分析攻击造成的危害。RFC 3562 建议一个加密周期（密钥投入使用的周期）至多为90天。更频繁的密钥更换会降低重放攻击（如上文提到的那样）的可行性。但是，因为缺乏标准机制能使如此频繁的密钥更换能在对等体之间协调，所以不能预设一个符合 RFC 定义的规则的 BGP-4 实现能够支持频繁的密钥更换。

显然地，每个密钥的选择都应是令攻击者难以猜测的那种。RFC 1750 中规定的关于随机数生成的技术提供了生成作为密钥的值的引导。RFC 2385 要求实现支持密钥由80字节或更少的可打印 ASCII 字符串组成。RFC 3562 建议密钥在此上下文中的使用应为12到24字节的随机（伪随机）位。这和类似 MAC 算法的建议相当相似，后者通常使用16到20字节长度的密钥。为在如此低的取值范围内提供足够的随机位，RFC 3562 还观察到典型的 ASCII 文本字符串应该能触碰到 RFC 2385 中定义的密钥长度的上界。

对 BGP 漏洞分析的讨论在 [[RFC4272](https://www.rfc-editor.org/rfc/rfc4272.html)] 中。